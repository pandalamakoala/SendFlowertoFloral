<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sihirli Buket</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&family=Great+Vibes&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">
    
    <style>
        /* --- AYDINLIK & SAKÄ°N ATMOSFER --- */
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #ffe4e1 0%, #ffdae0 100%); /* Toz Pembe */
            margin: 0; padding: 0; height: 100vh;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            overflow: hidden; color: #555;
        }

        /* UÃ§uÅŸan Kelebek Emojileri */
        .bg-butterfly {
            position: absolute; font-size: 25px;
            opacity: 0.7; pointer-events: none; user-select: none; z-index: 0;
            animation: flutter 20s linear infinite;
        }
        @keyframes flutter {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(50px, -50px) rotate(15deg); }
            50% { transform: translate(0, -100px) rotate(-15deg) scaleX(-1); }
            75% { transform: translate(-50px, -50px) rotate(15deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        /* --- KONTROL PANELÄ° --- */
        #creatorPanel {
            background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px);
            padding: 25px; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.6);
            width: 90%; max-width: 320px;
            text-align: center; z-index: 1000;
        }
        h1 { font-family: 'Great Vibes', cursive; color: #d81b60; margin: 0 0 15px 0; font-size: 32px; }
        
        input, select, textarea {
            width: 100%; padding: 10px; margin: 6px 0;
            border-radius: 10px; border: 1px solid #f8bbd0;
            background: rgba(255,255,255,0.7); outline: none;
            font-family: inherit; box-sizing: border-box;
        }
        input:focus, select:focus, textarea:focus { border-color: #d81b60; background: #fff; }
        
        button.main-btn {
            width: 100%; padding: 12px; margin-top: 15px;
            background: linear-gradient(135deg, #ff80ab, #ff4081); color: white;
            border: none; border-radius: 50px; font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 64, 129, 0.3); transition: transform 0.2s;
        }
        button.main-btn:hover { transform: scale(1.03); }

        /* --- SAHNE --- */
        #sceneContainer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; align-items: center; justify-content: flex-end;
            padding-bottom: 60px; z-index: 500;
        }

        /* El YazÄ±sÄ± BaÅŸlÄ±k (Kimden Kime) */
        #headerTitle {
            position: fixed; top: 30px; width: 100%; text-align: center;
            font-family: 'Dancing Script', cursive; font-size: 28px; color: #880e4f;
            z-index: 600; text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
            display: none;
        }

        /* --- BUKET YAPISI (DigitalBouquet TarzÄ±) --- */
        .bouquet-wrapper {
            position: relative; width: 240px; height: 380px;
            margin-bottom: 30px;
            animation: gentleFloat 4s ease-in-out infinite;
        }

        /* KaÄŸÄ±t Paket */
        .paper-wrap {
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 0; height: 0;
            border-left: 80px solid transparent;
            border-right: 80px solid transparent;
            border-top: 240px solid #f3e5f5; /* Lila KaÄŸÄ±t */
            filter: drop-shadow(0 15px 20px rgba(0,0,0,0.1));
            z-index: 10;
        }
        /* KaÄŸÄ±dÄ±n Ä°Ã§ KÄ±smÄ± */
        .paper-wrap::after {
            content: ''; position: absolute; top: -240px; left: -80px;
            width: 160px; height: 50px;
            background: #e1bee7; border-radius: 50%;
        }

        /* Ã‡iÃ§ekler (SÄ±kÄ± DÃ¼zen) */
        .flower-cluster {
            position: absolute; bottom: 210px; left: 50%; transform: translateX(-50%);
            width: 180px; height: 140px; z-index: 5;
            display: flex; flex-wrap: wrap; justify-content: center; align-items: flex-end;
        }
        .flower-item {
            font-size: 55px; line-height: 0.7; position: absolute;
            filter: drop-shadow(0 5px 8px rgba(0,0,0,0.15));
            transition: transform 0.3s;
            animation: bloom 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .flower-item:hover { transform: scale(1.1) rotate(5deg); z-index: 100 !important; }

        /* --- ZARF (Merkezde) --- */
        .note-card {
            position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%) rotate(-2deg);
            background: #fff; padding: 15px; width: 180px;
            border-radius: 6px; box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            text-align: center; font-family: 'Great Vibes', cursive;
            font-size: 20px; color: #880e4f; z-index: 20;
            border-top: 4px solid #ff80ab; opacity: 0; animation: popIn 0.8s forwards 0.5s;
        }

        /* --- BUTONLAR (KÃ¶ÅŸelerde) --- */
        #linkBtnArea { position: fixed; bottom: 20px; right: 20px; z-index: 1000; display: none; }
        #createBtnArea { position: fixed; bottom: 20px; left: 20px; z-index: 1000; display: none; }
        
        .corner-btn {
            background: white; color: #d81b60; padding: 10px 20px;
            border-radius: 30px; border: none; font-weight: bold; font-size: 14px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer;
            transition: transform 0.2s; display: flex; align-items: center; gap: 5px;
        }
        .corner-btn:hover { transform: translateY(-3px); }

        @keyframes gentleFloat { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        @keyframes bloom { from { transform: scale(0); } to { transform: scale(1); } }
        @keyframes popIn { from { transform: translateX(-50%) scale(0); opacity: 0; } to { transform: translateX(-50%) rotate(-2deg) scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <div id="butterflyContainer"></div>

    <div id="headerTitle"></div>

    <div id="creatorPanel">
        <h1>âœ¨ Sihirli Buket âœ¨</h1>
        
        <input type="text" id="senderName" placeholder="GÃ¶nderen AdÄ± (Ã–rn: Ali)">
        <input type="text" id="receiverName" placeholder="AlÄ±cÄ± AdÄ± (Ã–rn: AyÅŸe)">

        <select id="zodiacSelect">
            <option value="">Bir Ã‡iÃ§ek SeÃ§...</option>
            <option value="koc">Lale ğŸŒ·</option>
            <option value="boga">GÃ¼l ğŸŒ¹</option>
            <option value="ikizler">Papatya ğŸŒ¼</option>
            <option value="yengec">NilÃ¼fer ğŸª·</option>
            <option value="aslan">AyÃ§iÃ§eÄŸi ğŸŒ»</option>
            <option value="basak">BaÅŸak ğŸŒ¾</option>
            <option value="terazi">Hibiskus ğŸŒº</option>
            <option value="akrep">Karanfil ğŸ¥€</option>
            <option value="yay">Mor Ã‡iÃ§ek ğŸª»</option>
            <option value="oglak">Rozet ğŸµï¸</option>
            <option value="kova">Orkide ğŸ’</option>
            <option value="balik">Bahar DalÄ± ğŸ’®</option>
        </select>
        
        <textarea id="userNote" rows="2" placeholder="KÄ±sa bir not..."></textarea>
        
        <button class="main-btn" onclick="createBouquet()">Buketi HazÄ±rla ğŸ’–</button>
    </div>

    <div id="sceneContainer">
        <div class="bouquet-wrapper">
            <div class="flower-cluster" id="flowerCluster"></div>
            <div class="paper-wrap"></div>
            <div class="note-card" id="displayNote"></div>
        </div>
    </div>

    <div id="linkBtnArea">
        <button class="corner-btn" onclick="copyLink()">ğŸ”— Linki Kopyala</button>
        <div id="copyMsg" style="text-align:right; font-size:12px; color:#d81b60; margin-top:5px; display:none;">KopyalandÄ±! âœ¨</div>
    </div>

    <div id="createBtnArea">
        <button class="corner-btn" onclick="window.location.href=window.location.pathname">ğŸŒ¸ Sen de Tasarla</button>
    </div>

    <script>
        // --- 1. KELEBEKLERÄ° OLUÅTUR ---
        function initButterflies() {
            const container = document.getElementById('butterflyContainer');
            for(let i=0; i<10; i++) {
                const b = document.createElement('div');
                b.className = 'bg-butterfly'; b.innerText = 'ğŸ¦‹';
                b.style.left = Math.random() * 100 + 'vw';
                b.style.top = Math.random() * 100 + 'vh';
                b.style.fontSize = (20 + Math.random() * 20) + 'px';
                b.style.animationDuration = (15 + Math.random() * 15) + 's';
                b.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(b);
            }
        }
        initButterflies();

        const flowers = {
            'koc': 'ğŸŒ·', 'boga': 'ğŸŒ¹', 'ikizler': 'ğŸŒ¼', 'yengec': 'ğŸª·',
            'aslan': 'ğŸŒ»', 'basak': 'ğŸŒ¾', 'terazi': 'ğŸŒº', 'akrep': 'ğŸ¥€',
            'yay': 'ğŸª»', 'oglak': 'ğŸµï¸', 'kova': 'ğŸ’', 'balik': 'ğŸ’®'
        };

        // --- 2. BUKET ALGORÄ°TMASI (SÄ±kÄ± DÃ¼zen) ---
        function buildBouquet(code) {
            const container = document.getElementById('flowerCluster');
            container.innerHTML = '';
            const icon = flowers[code] || 'ğŸŒ¸';

            // 15 Ã‡iÃ§ek iÃ§in SÄ±kÄ± Koordinatlar (Piramit ÅŸeklinde)
            const positions = [
                // Arka SÄ±ra (En geniÅŸ, en altta)
                { bottom: 35, left: -50, z: 1, s: 0.9 }, { bottom: 40, left: -20, z: 1, s: 1.0 },
                { bottom: 40, left: 20, z: 1, s: 1.0 },  { bottom: 35, left: 50, z: 1, s: 0.9 },
                // Orta SÄ±ra
                { bottom: 65, left: -35, z: 2, s: 1.1 }, { bottom: 75, left: 0, z: 2, s: 1.2 },
                { bottom: 65, left: 35, z: 2, s: 1.1 },
                // Ã–n SÄ±ra
                { bottom: 95, left: -20, z: 3, s: 1.3 }, { bottom: 95, left: 20, z: 3, s: 1.3 },
                // En Tepe (Tek Ã‡iÃ§ek)
                { bottom: 125, left: 0, z: 4, s: 1.4 }
            ];

            // Geri kalanlarÄ± rastgele doldur
            for(let i=10; i<15; i++) {
                positions.push({
                    bottom: 50 + Math.random()*60,
                    left: (Math.random()*80 - 40),
                    z: 2, s: 0.8 + Math.random()*0.3
                });
            }

            positions.forEach((pos, index) => {
                const el = document.createElement('div');
                el.className = 'flower-item'; el.innerText = icon;
                el.style.left = `calc(50% + ${pos.left}px)`;
                el.style.bottom = `${pos.bottom}px`;
                el.style.zIndex = pos.z;
                const rot = (Math.random() * 20 - 10);
                el.style.transform = `translateX(-50%) rotate(${rot}deg) scale(${pos.s})`;
                el.style.animation = `bloom 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards ${index * 0.05}s`;
                container.appendChild(el);
            });
        }

        function createBouquet() {
            const sender = document.getElementById('senderName').value;
            const receiver = document.getElementById('receiverName').value;
            const code = document.getElementById('zodiacSelect').value;
            const note = document.getElementById('userNote').value;

            if(!code) { alert("LÃ¼tfen bir Ã§iÃ§ek seÃ§in âœ¨"); return; }
            if(!sender || !receiver) { alert("LÃ¼tfen isimleri girin âœ¨"); return; }

            showScene(sender, receiver, code, note);
        }

        function showScene(sender, receiver, code, note) {
            document.getElementById('creatorPanel').style.display = 'none';
            document.getElementById('sceneContainer').style.display = 'flex';
            document.getElementById('linkBtnArea').style.display = 'block';
            document.getElementById('createBtnArea').style.display = 'block';

            // BaÅŸlÄ±ÄŸÄ± Ayarla
            const title = document.getElementById('headerTitle');
            title.innerText = `${sender}'den ${receiver}'e ğŸ’–`;
            title.style.display = 'block';

            buildBouquet(code);

            // Notu Ayarla
            const card = document.getElementById('displayNote');
            let finalNote = "";
            if(note) finalNote += `"${note}"\n`;
            finalNote += `~ ${sender}`;
            card.innerText = finalNote;
        }

        function copyLink() {
            const sender = document.getElementById('senderName').value;
            const receiver = document.getElementById('receiverName').value;
            const code = document.getElementById('zodiacSelect').value;
            const note = document.getElementById('userNote').value;

            const url = `${window.location.href.split('?')[0]}?s=${encodeURIComponent(sender)}&r=${encodeURIComponent(receiver)}&c=${code}&n=${encodeURIComponent(note)}`;
            
            navigator.clipboard.writeText(url).then(() => {
                const msg = document.getElementById('copyMsg');
                msg.style.display = 'block'; setTimeout(()=>msg.style.display='none', 2000);
            });
        }

        // --- LINK Ä°LE GELÄ°NDÄ°YSE ---
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const s = params.get('s'); // Sender
            const r = params.get('r'); // Receiver
            const c = params.get('c'); // Code
            const n = params.get('n'); // Note

            if(s && r && c) {
                // Formu doldur (Kopyalama iÃ§in)
                document.getElementById('senderName').value = s;
                document.getElementById('receiverName').value = r;
                document.getElementById('zodiacSelect').value = c;
                if(n) document.getElementById('userNote').value = n;

                showScene(s, r, c, n);
            }
        };
    </script>
</body>
</html>
